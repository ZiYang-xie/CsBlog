!function(s,c){function u(a,l){return new Promise(function(o,r){a("get","/classes/Counter?where="+encodeURIComponent(JSON.stringify({target:l}))).then(e=>e.json()).then(({results:e,code:t,error:n})=>{if(401===t)throw n;e&&0<e.length?(t=e[0],o(t)):a("post","/classes/Counter",{target:l,time:0}).then(e=>e.json()).then((e,t)=>{if(t)throw t;o(e)}).catch(e=>{console.error("Failed to create",e),r(e)})}).catch(e=>{console.error("LeanCloud Counter Error:",e),r(e)})})}function h(e){return{method:"PUT",path:"/1.1/classes/Counter/"+e,body:{time:{__op:"Increment",amount:1}}}}function e(t){var e,o=!0===CONFIG.web_analytics.enable,n=[],r=[],a=c.querySelector("#leancloud-site-pv-container"),l=(a&&(e=u(t,"site-pv").then(e=>{o&&r.push(h(e.objectId));var t=c.querySelector("#leancloud-site-pv");t&&(t.innerText=e.time+1,a)&&(a.style.display="inline")}),n.push(e)),c.querySelector("#leancloud-site-uv-container")),i=(l&&(e=u(t,"site-uv").then(e=>{n="LeanCloud_UV_Flag";var t=!((t=localStorage.getItem(n))&&(new Date).getTime()-parseInt(t,10)<=864e5||(localStorage.setItem(n,(new Date).getTime().toString()),0)),n=(t&&o&&r.push(h(e.objectId)),c.querySelector("#leancloud-site-uv"));n&&(n.innerText=e.time+(t?1:0),l)&&(l.style.display="inline")}),n.push(e)),c.querySelector("#leancloud-page-views-container"));i&&(e=decodeURI(s.location.pathname),e=u(t,e).then(e=>{var t;o&&r.push(h(e.objectId)),i&&(t=c.querySelector("#leancloud-page-views"))&&(t.innerText=(e.time||0)+1,i.style.display="inline")}),n.push(e)),o&&Promise.all(n).then(()=>{var e,o;0<r.length&&(e=t,o=r,new Promise(function(t,n){e("post","/batch",{requests:o}).then(e=>{if((e=e.json()).error)throw e.error;t(e)}).catch(e=>{console.error("Failed to save visitor count",e),n(e)})}))})}var r=CONFIG.web_analytics.leancloud.app_id,a=CONFIG.web_analytics.leancloud.app_key,t=CONFIG.web_analytics.leancloud.server_url;function n(o){e((e,t,n)=>fetch(o+"/1.1"+t,{method:e,headers:{"X-LC-Id":r,"X-LC-Key":a,"Content-Type":"application/json"},body:JSON.stringify(n)}))}t="-MdYXbMMI"!==r.slice(-9)?t:`https://${r.slice(0,8).toLowerCase()}.api.lncldglobal.com`;t?n(t):fetch("https://app-router.leancloud.cn/2/route?appId="+r).then(e=>e.json()).then(({api_server:e})=>{n("https://"+e)})}(window,document);