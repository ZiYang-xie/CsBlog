<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/CsBlog/img/favicon.png"><link rel="icon" type="image/png" href="/CsBlog/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content=""><meta name="author" content="Xzy"><meta name="keywords" content=""><title>Locality Principle - ZiYang&#39;s Blog</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="/CsBlog/lib/hint/hint.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.2/styles/github-gist.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/CsBlog/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"ziyang-xie.github.io",root:"/CsBlog/",version:"1.8.5",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},copy_btn:!0,image_zoom:{enable:!0},lazyload:{enable:!0,onlypost:!1},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}}}</script><script src="/CsBlog/js/utils.js"></script><script src="/CsBlog/js/color-schema.js"></script><meta name="generator" content="Hexo 5.2.0"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/CsBlog/">&nbsp;<strong>ZiYang-Xie's Blog</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/CsBlog/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/CsBlog/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/CsBlog/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/CsBlog/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/CsBlog/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" href="javascript:">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner intro-2" id="background" parallax="true" style="background:url(/CsBlog/img/bg_in.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="Locality Principle"></span><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2021-10-15 10:29" pubdate>2021年10月15日 上午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 882 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 17 分钟</span></div></div></div></div></div></header><main><div class="container-fluid"><div class="row"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-md"><div class="container nopadding-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">Locality Principle</h1><div class="markdown-body"><h3 id="1-1-Intro"><a href="#1-1-Intro" class="headerlink" title="1.1 Intro"></a>1.1 Intro</h3><p>​ Locality Principle is a profound law of computing and has a wide application in many modern areas in computer science — virtual memory, cache, database, etc. It is the combination of two locality aspects:</p><ul><li><em>(1) temporal locality</em></li><li><em>(2) spatial locality</em></li></ul><p>​ The success of the locality principle attributes to the fact that locality works aline with human cognitive and coordinative behavior. <em>Divide and conquer</em> is the most common practice for humans when dealing with complex problems. We tend to break it into some small parts and work on them separately. Here is where the locality lies in.</p><p>​ Understanding the locality principle can benefit a lot, including making better use of cache, predicting the phase boundaries, and extending to many different aspects in computer science, even our daily lives.</p><h3 id="1-2-History"><a href="#1-2-History" class="headerlink" title="1.2 History"></a>1.2 History</h3><p>​ Looking backward, locality has emerged from the design of virtual memory systems back to 1959, the Atlas system. There were two main performance problems at that time. One is the address location problem, which is quickly solved by page table and TLB, while the another hard nut is the replacement problem of the demand-paged virtual memory. Replacing the page that will not be used again for the longest time is a common belief, but obviously people can’t estimate the next-use time for sure.</p><p>​ 1966 Belady’s study pointed out that the performance under certain replacement strategy primarily depended on the way how compiler grouped the code blocks onto pages. Shortly after that, thrashing problem was discovered and swiftly became the nightmare for companies using virtual memory. IBM OS360 even excluded the virtual memory, for example.</p><p>​ By 1966,in Watson Lab, Belady and his partners had tested every replacement policy, and found the LRU (least recently used) replacement got the best performance, because of the reference clustering locality behavior. By using locality notion, MIT Project MAC defined the Intrinsic demand, the first kind of “<em>Working Set</em>“ at the same year.</p><p>​ As it is explained in Denning’s paper<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="Denning, P. J. . Peter J. Denning. The Locality Principle. In Communication Networks and Computer Systems (J. Barria, Ed.). Imperial College Press (2006), 43-67. CHAPTER 4 The Locality Principle.
">[1]</span></a></sup></p><blockquote><p>The working-set idea worked because the pages observed in the backward window were highly likely to be used again in the immediate future.</p></blockquote><p>​ The underlying mechanism of it is temporal and spatial locality.</p><h3 id="1-3-Core"><a href="#1-3-Core" class="headerlink" title="1.3 Core"></a>1.3 Core</h3><p>​ Locality principle hit the key of general program behavior, which is strongly connected with people’s coding style when solving a problem — <em>Divide and Conquer</em>. This coding style is shown as temporal and spatial clustering on data structures.</p><p>​ For instance, when people doing a loop, the variables inside the loop are often changed constantly, which is a kind of temporal clustering. In terms of spatial clustering, Array is an example when we put data into it and access it sequentially.</p><p>​ The Locality principle can be applied through a distance function $D(x,t)$ to measure temporal of spatial locality, and we use $D(x, t) &lt; T$ to describe the locality set of $x$ at time $t$, and the working set model can be expressed by $W(t, T)$ , $T$ is the time window from the current time $t$. It is a efficient way to track the phases of a program in a dynamic manner, instead of the traditional <em>static representation</em> following <em>Zipf Law</em></p><p>​ The modern model of locality are more about context-awareness with four key ideas</p><ul><li><strong>An Observer:</strong> Agent doing tasks with the help of software</li><li><strong>Neighborhoods:</strong> Group of obejcts</li><li><strong>Inference:</strong> Method measures the content of neighborhoods</li><li><strong>Optimal Actions:</strong> actions performed by software</li></ul><h3 id="1-4-Application"><a href="#1-4-Application" class="headerlink" title="1.4 Application"></a>1.4 Application</h3><p>​ Locality principle has a wide-spread application in the computer field, for example, in the Search Engine area. Many search engine companies such as Google, using locality to arrange the outside data. Utilizing cache to speed up the searching process, sort the relative result and recent search log together, a typical example of the spatial and temporal locality.</p><hr><h2 id="2-Page-Coloring"><a href="#2-Page-Coloring" class="headerlink" title="2. Page Coloring"></a>2. Page Coloring</h2><p>​ After wide application of virtual memory, people found that the Arbitrary Mapping between virtual page and physical page will cause the nonuniform use of Cache. Because of the locality principle, the data are mapping close to each other, resulting in the cache swap in and out constantly, causing thrashing.</p><p>​ By 1985, MIPS raised the page coloring technique <sup id="fnref:2" class="footnote-ref"><a href="#fn:2" rel="footnote"><span class="hint--top hint--rounded" aria-label="TAYLOR, G., DAVIES, P., ANDFARAWAY,D, M. The TLB slice—A low-cost high-speed address translation mechanism. In ISCA-1990.
">[2]</span></a></sup> to solve that problem. Simply put, Page coloring is a technique that splitting the pages into many groups with different color and using the middle bit of virtual mem block to represent the group and map it to the corresponding physical page. This method separates the interrelated data into different parts of memory and cache block, solving the thrashing problems.</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gvfslxmzuxj618v0u00xi02.jpg" srcset="/CsBlog/img/loading.gif" style="zoom:40%"></p><p>​ Page coloring is easy to code, deploy and has a great improvement on system performance. After using page coloring the page non-assess correlation dropped significantly.<sup id="fnref:3" class="footnote-ref"><a href="#fn:3" rel="footnote"><span class="hint--top hint--rounded" aria-label="Zhang, X., Dwarkadas, S., &amp; Shen, K. (2009). Towards Practical Page Coloring-Based Multicore Cache Management. In Proceedings of the 4th ACM European Conference on Computer Systems (pp. 89–102). Association for Computing Machinery.
">[3]</span></a></sup> today page coloring are being widely used in cache designing with different sample method.</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNly1gvfsmp3635j60g50cw75c02.jpg" srcset="/CsBlog/img/loading.gif" style="zoom:60%"></p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>Denning, P. J. . Peter J. Denning. The Locality Principle. In Communication Networks and Computer Systems (J. Barria, Ed.). Imperial College Press (2006), 43-67. CHAPTER 4 The Locality Principle. <a href="#fnref:1" rev="footnote" class="footnote-backref">↩</a></span></span></li><li><span id="fn:2" class="footnote-text"><span>TAYLOR, G., DAVIES, P., ANDFARAWAY,D, M. The TLB slice—A low-cost high-speed address translation mechanism. In ISCA-1990. <a href="#fnref:2" rev="footnote" class="footnote-backref">↩</a></span></span></li><li><span id="fn:3" class="footnote-text"><span>Zhang, X., Dwarkadas, S., &amp; Shen, K. (2009). Towards Practical Page Coloring-Based Multicore Cache Management. In <em>Proceedings of the 4th ACM European Conference on Computer Systems</em> (pp. 89–102). Association for Computing Machinery. <a href="#fnref:3" rev="footnote" class="footnote-backref">↩</a></span></span></li></ol></div></section></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/CsBlog/categories/OS/">OS</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/CsBlog/tags/OS/">OS</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext row"><article class="post-prev col-6"><a href="/CsBlog/2021/11/15/OS/Unix/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">「论文阅读」The Unix Time-Sharing System</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/CsBlog/2021/10/15/OS/OS-Evolution-01/"><span class="hidden-mobile">OS Evolution Report</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments"><div id="gitalk-container"></div><script type="text/javascript">Fluid.utils.waitElementVisible("gitalk-container",(function(){Fluid.utils.createCssLink("/CsBlog/css/gitalk.css"),Fluid.utils.createScript("https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.7.0/gitalk.min.js",(function(){new Gitalk({clientID:"bb132e59582b2e328abc",clientSecret:"884bfc0ac692d040744d5e4b81ffd6f1aa95cbc0",repo:"CsBlog",owner:"ZiYang-xie",admin:["ZiYang-xie"],id:"8dac8b77dc99e4742644e5150cc98a8e",language:"zh-CN",labels:["Gitalk"],perPage:10,pagerDirection:"last",createIssueManually:!0,distractionFreeMode:!1}).render("gitalk-container")}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><p>Fight For The Happiness of Humanity</p><div><span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span><script src="/CsBlog/js/duration.js"></script></div></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div><div class="beian"><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">沪ICP备20009486号-1</a></div></footer><script src="https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:200}),NProgress.start(),document.addEventListener("DOMContentLoaded",(function(){window.NProgress&&window.NProgress.inc()})),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.min.js"></script><script src="/CsBlog/js/debouncer.js"></script><script src="/CsBlog/js/events.js"></script><script src="/CsBlog/js/plugins.js"></script><script src="/CsBlog/js/lazyload.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.12.0/tocbot.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js"></script><script defer src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.11/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script src="/CsBlog/js/local-search.js"></script><script>document.querySelector("#local-search-input").onclick=function(){searchFunc("/CsBlog/local-search.xml","local-search-input","local-search-result"),this.onclick=null}</script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},options:{renderActions:{findScript:[10,e=>{document.querySelectorAll('script[type^="math/tex"]').forEach(t=>{const n=!!t.type.match(/; *mode=display/),o=new e.options.MathItem(t.textContent,e.inputJax[0],n),a=document.createTextNode("");t.parentNode.replaceChild(a,t),o.start={node:a,delim:"",n:0},o.end={node:a,delim:"",n:0},e.math.push(o)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}}</script><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.1.2/es5/tex-svg.js"></script><script src="/CsBlog/js/boot.js"></script></body></html>